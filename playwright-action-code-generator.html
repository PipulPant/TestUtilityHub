<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Playwright Action Code Generator - QA Test Utility Hub</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="styles.css">
</head>
<body class="utility-page">
<header>
  <i class="fas fa-bars hamburger" onclick="toggleSidebar()"></i>
  <h1><i class="fas fa-code"></i> Playwright Action Code Generator</h1>
  <a href="index.html" class="home-icon"><i class="fas fa-home"></i></a>
</header>
<div class="sidebar" id="sidebar"></div>
<div class="content">
  <div class="container">
    <h2>Generate Playwright Action Code</h2>
    <form id="actionCodeForm">
      <label for="selectorInput">CSS Selector or Locator:</label>
      <input type="text" id="selectorInput" placeholder="e.g., .button, #main-header, text=Submit" required>
      <label for="actionType">Choose Action:</label>
      <select id="actionType" onchange="toggleAdditionalInputs()" required>
        <option value="click">Click</option>
        <option value="type">Type</option>
        <option value="fill">Fill</option>
        <option value="press">Press Key</option>
        <option value="upload">Upload File</option>
        <option value="hover">Hover</option>
        <option value="waitFor">Wait for Visibility</option>
        <option value="screenshot">Take Screenshot</option>
        <option value="select">Select Option</option>
        <option value="check">Check Checkbox</option>
        <option value="uncheck">Uncheck Checkbox</option>
        <option value="dragDrop">Drag and Drop</option>
      </select>
      <div id="valueContainer" style="display: none;">
        <label for="actionValue" id="valueLabel">Value:</label>
        <input type="text" id="actionValue" placeholder="Enter value">
      </div>
      <div id="secondValueContainer" style="display: none;">
        <label for="secondValue" id="secondValueLabel">Second Value:</label>
        <input type="text" id="secondValue" placeholder="Enter second value">
      </div>
      <label>
        <input type="checkbox" id="useLocator" style="width: auto; margin-right: 8px;">
        Use Locator API (recommended)
      </label>
      <button type="button" onclick="generateActionCode()">
        <i class="fas fa-code"></i> GENERATE CODE
      </button>
    </form>
    <div class="result" id="actionCodeResult" style="display: none;">
      <div id="codeOutput"></div>
      <button class="copy-btn secondary" onclick="copyCode()">
        <i class="fas fa-copy"></i> Copy Code
      </button>
    </div>
  </div>
</div>
<script src="common.js"></script>
<script>
  let generatedCode = '';
  function toggleAdditionalInputs() {
    const actionType = document.getElementById("actionType").value;
    const valueContainer = document.getElementById("valueContainer");
    const secondValueContainer = document.getElementById("secondValueContainer");
    const valueLabel = document.getElementById("valueLabel");
    const actionValue = document.getElementById("actionValue");
    if (actionType === "type" || actionType === "fill" || actionType === "press" || 
        actionType === "upload" || actionType === "select" || actionType === "dragDrop") {
      valueContainer.style.display = "block";
      if (actionType === "press") {
        valueLabel.innerText = "Key:";
        actionValue.placeholder = "e.g., Enter, Escape, ArrowDown";
      } else if (actionType === "upload") {
        valueLabel.innerText = "File Path:";
        actionValue.placeholder = "e.g., /path/to/file.pdf";
      } else if (actionType === "select") {
        valueLabel.innerText = "Option Value:";
        actionValue.placeholder = "e.g., option1 or text=Option 1";
      } else if (actionType === "dragDrop") {
        valueLabel.innerText = "Target Selector:";
        actionValue.placeholder = "e.g., #drop-zone";
      } else {
        valueLabel.innerText = "Text:";
        actionValue.placeholder = "e.g., Hello World";
      }
      if (actionType === "dragDrop") {
        secondValueContainer.style.display = "block";
        document.getElementById("secondValueLabel").innerText = "Target Selector:";
        document.getElementById("secondValue").placeholder = "e.g., #drop-zone";
      } else {
        secondValueContainer.style.display = "none";
      }
    } else {
      valueContainer.style.display = "none";
      secondValueContainer.style.display = "none";
    }
  }
  function generateActionCode() {
    const selector = document.getElementById("selectorInput").value;
    const actionType = document.getElementById("actionType").value;
    const actionValue = document.getElementById("actionValue").value;
    const secondValue = document.getElementById("secondValue").value;
    const useLocator = document.getElementById("useLocator").checked;
    const resultDiv = document.getElementById("actionCodeResult");
    const codeDiv = document.getElementById("codeOutput");
    let codeSnippet = "";
    const locatorVar = selector.includes('=') || selector.includes('(') ? `page.locator('${selector}')` : `page.locator('${selector}')`;
    const selectorVar = `page.locator('${selector}')`;
    const api = useLocator ? selectorVar : `page`;
    switch (actionType) {
      case "click":
        codeSnippet = useLocator 
          ? `// Click on element\nawait ${selectorVar}.click();`
          : `// Click on element\nawait page.click('${selector}');`;
        break;
      case "type":
        if (!actionValue) {
          codeDiv.innerHTML = "<p class='error'>Please provide text to type.</p>";
          resultDiv.style.display = 'block';
          return;
        }
        codeSnippet = useLocator
          ? `// Type into element\nawait ${selectorVar}.type('${actionValue}');`
          : `// Type into element\nawait page.type('${selector}', '${actionValue}');`;
        break;
      case "fill":
        if (!actionValue) {
          codeDiv.innerHTML = "<p class='error'>Please provide text to fill.</p>";
          resultDiv.style.display = 'block';
          return;
        }
        codeSnippet = useLocator
          ? `// Fill input field\nawait ${selectorVar}.fill('${actionValue}');`
          : `// Fill input field\nawait page.fill('${selector}', '${actionValue}');`;
        break;
      case "press":
        if (!actionValue) {
          codeDiv.innerHTML = "<p class='error'>Please provide a key to press.</p>";
          resultDiv.style.display = 'block';
          return;
        }
        codeSnippet = useLocator
          ? `// Press a key\nawait ${selectorVar}.press('${actionValue}');`
          : `// Press a key\nawait page.press('${selector}', '${actionValue}');`;
        break;
      case "upload":
        if (!actionValue) {
          codeDiv.innerHTML = "<p class='error'>Please provide a file path to upload.</p>";
          resultDiv.style.display = 'block';
          return;
        }
        codeSnippet = useLocator
          ? `// Upload a file\nawait ${selectorVar}.setInputFiles('${actionValue}');`
          : `// Upload a file\nawait page.setInputFiles('${selector}', '${actionValue}');`;
        break;
      case "hover":
        codeSnippet = useLocator
          ? `// Hover over element\nawait ${selectorVar}.hover();`
          : `// Hover over element\nawait page.hover('${selector}');`;
        break;
      case "waitFor":
        codeSnippet = useLocator
          ? `// Wait for element to be visible\nawait ${selectorVar}.waitFor({ state: 'visible' });`
          : `// Wait for element to be visible\nawait page.waitForSelector('${selector}', { state: 'visible' });`;
        break;
      case "screenshot":
        codeSnippet = useLocator
          ? `// Take screenshot of element\nawait ${selectorVar}.screenshot({ path: 'screenshot.png' });`
          : `// Take screenshot\nawait page.screenshot({ path: 'screenshot.png' });`;
        break;
      case "select":
        if (!actionValue) {
          codeDiv.innerHTML = "<p class='error'>Please provide an option value.</p>";
          resultDiv.style.display = 'block';
          return;
        }
        codeSnippet = useLocator
          ? `// Select option\nawait ${selectorVar}.selectOption('${actionValue}');`
          : `// Select option\nawait page.selectOption('${selector}', '${actionValue}');`;
        break;
      case "check":
        codeSnippet = useLocator
          ? `// Check checkbox\nawait ${selectorVar}.check();`
          : `// Check checkbox\nawait page.check('${selector}');`;
        break;
      case "uncheck":
        codeSnippet = useLocator
          ? `// Uncheck checkbox\nawait ${selectorVar}.uncheck();`
          : `// Uncheck checkbox\nawait page.uncheck('${selector}');`;
        break;
      case "dragDrop":
        if (!actionValue || !secondValue) {
          codeDiv.innerHTML = "<p class='error'>Please provide both source and target selectors.</p>";
          resultDiv.style.display = 'block';
          return;
        }
        const sourceLocator = useLocator ? `page.locator('${selector}')` : `page.locator('${selector}')`;
        const targetLocator = useLocator ? `page.locator('${secondValue}')` : `page.locator('${secondValue}')`;
        codeSnippet = `// Drag and drop\nawait ${sourceLocator}.dragTo(${targetLocator});`;
        break;
      default:
        codeSnippet = "// Select a valid action.";
    }
    generatedCode = codeSnippet;
    codeDiv.innerHTML = `
      <p class="success">Generated Playwright Code:</p>
      <div class="code-output">${escapeHtml(codeSnippet)}</div>
    `;
    resultDiv.style.display = 'block';
  }
  function copyCode() {
    if (generatedCode) {
      copyToClipboard(generatedCode, event.target.closest('button'));
    }
  }
  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }
  window.onload = () => toggleAdditionalInputs();
</script>
</body>
</html>
